Código simple para reconstruir la masa transversa del bosón W

Código:

/ All libraries you could wish for
#include <iostream>                 // class for inputoutput streams
#include <stdio.h>                  // printf, scanf, puts, NULL
#include <stdlib.h>                 // srand, rand, atof
#include <time.h>                   // time
#include <fstream>                  // class for inputoutput file streams
#include <dirent.h>
#include <string.h>           // class to manipulate strings
#include <sstream>                    // class for parsing strings
#include <vector>


#include <TROOT.h>
#include <TChain.h>
#include <TFile.h>
#include <TH1F.h>
#include <TF1.h>
#include <TCanvas.h>
#include <TPaveStats.h>
#include <TPad.h>
#include <TMath.h>
#include <TStyle.h>
#include <TSystem.h>
#include <TLegend.h>
#include <TString.h>
#include <TGraph.h>
#include <TLatex.h>



#include <unistd.h>
#define GetCurrentDir getcwd

#include <TTree.h>

using namespace std;
int main(int argc, char* argv[])
{
  //Cargamos el archivo con los datos
  //Entre las comillas tienes que poner la dirección del archivo en tu computadora
  TFile* file = TFile::Open("/Users/Fer/Documents/traajo/samples/NeroNtuples_9.root"); 
  //Obtenemos el árbol con los datos
  TTree *tree=(TTree*)file->Get("nero/events");
  //Creamos el lienzo donde se hará la imagen
  TCanvas* c1 = new TCanvas("c1", "Masa W", 600, 600);
  //Aquí es donde la magia sucede
  tree->Draw("sqrt((lepP4.Energy())^2-(lepP4.Px()+lepP4.Py()+lepP4.Pz())^2)+sqrt((metP4.Energy())^2-(metP4.Px()+metP4.Py()+metP4.Pz())^2)","lepPdgId>abs(11)");
  //Primero decimos que vamos a usar el método "Draw" con datos del objeto "tree"
  //Sigue específicar que datos vamos a utilizar y como
  //La fórmula de la masa transversa es "m=√(E^2-|p|^2)"
  //Especificaremos hasta el final que usaremos la energía y momentum de los electrones
  //el como se especifica se explica al final
  //Primero abrimos la raíz cuadrada
  //Dentro de ella calculamos el cuadrado de la energía de cada evento de leptones (lepP4)
  //y le restamos la magnitud del vector de momentum de los leptones
  //Luego hacemos los mismo con la energía y el momentum perdidos
  //no es necesario especificar nada para la energía y el momentum perdidos
  //Otenemos dos masas en cada raíz y las sumamos
  //Para especificar que usaremos la energía y momentum de los electrones usamos "lepPdgId>abs(11)"
  //Que dice que de "lepP4" use solo los eventos con identificador 11 o -11, que es el de los eletrones
  //o antielectrones, por eso el abs() 
  //Guardamos la imagen
  c1->SaveAs("masaW.pdf");
  c1->Close();
  return 0;
}


Preámbulo:
Serás dado un folder con el nombre “traajo” este folder contendrá a su vez dos folders, “myprogram1” y “samples”, “myprogram1” tendrá dentro los folders “bin” y “lib” y el archivo “makefile”, mientras que “samples” tendrá dentro “NeroNtuples_9.root”.

Requerimientos generales:
1.-Haber instalado Root
2.-Tener el folder previamente mencionado con el contenido indicado
3.-Usar un sistema operativo de Unix (Mac o Linux)



Requerimientos de la terminal:
Esto puede ser ligeramente diferente dependiendo de tu sistema operativo, como referencia yo uso “Mac OS X 10.11.5 64-bit”.
1.-Abre tu terminal
2.-Introduce el siguiente código y da enter: vi ~/.bashrc
3.-Se abrirá dentro de la terminal tu “bash”
4.-Presiona la tecla de dirección hacia abajo hasta que ya no puedas bajar (no podrás llegar hasta abajo)
5.-Cuando ya no puedas bajar más copia y pega las siguientes instrucciones:

export ROOTSYS=/Users/Fer/root/root-6.06.06
source $ROOTSYS/bin/thisroot.sh
export PATH=$ROOTSYS/bin:$PATH

Nota que en la primera instrucción necesitas especificar la dirección de donde está Root en tu computadora

6.-Finalmente tienes que guardar estos cambios, para esto escribe “:q” y presiona la tecla enter


Instrucciones:
1.-Copiar el código y pegarlo en un procesador de textos como TextEdit, Sublime Text 2, NotePad, o similares

2.-En la línea 41 donde se carga el archivo entre las comillas tienes que poner la dirección del archivo en tu computadora, por ejemplo en mi caso es “/Users/Fer/Documents/traajo/samples/NeroNtuples_9.root”
en tu caso debería de ser similar desde “/traajo/samples/NeroNtuples_9.root”

3.-Guardar el archivo del código en el folder “myprogram1” con la extensión .cpp y con el nombre “myprogram1”, tiene que ser ese nombre por razones que se explicarán más adelante

4.-Abrir la terminal, esto se hace diferente en diferentes sistemas operativos. Si no sabes como usar la terminal a mi me sirvió mucho esta página

5.-Usa la terminal de tu sistema operativo para llegar al folder “miprogram1”, si usas OS o Linux, al escribir “ls” en tu terminal deberías de poder ver en este momento los archivos contenidos en el folder “miprogram1”, los folders “bin” y “lib”, el archivo “makefile”, y ahora también “myprogram1.cpp”. 
Si ves el folder y no únicamente sus archivos tienes que entrar al folder

6.-Tienes que activar el archivo “makefile” que debe de estar en el folder “miprogram1”. Para esto si tienes OS o Linux solo escribe “make” en tu terminal 

Nota sobre el “makefile”:
Este archivo en una “caja negra”, no importa que no sepas como funciona, sino como usarlo.
Este archivo lee códigos de root, y c++ en general, y construye con lo que leyó algo que la computadora puede entender, se conocen como “ejecutables” y suelen ser .exec, .exe, o .dmg.
Hacer este proceso se conoce como “compilar”.
Este archivo tiene una parte en la que dice que el archivo al que debe de convertir en un ejecutable se llama “myprogram1” por eso es importante guardar el código con ese nombre, pero eres libre de cambiar esa línea de texto y hacer que compile programas con otro nombre si quieres

Esta es la parte del “makefile” que cambiarías, solo la parte del final:

############################################################################
# Build main.c compiling only the first prereq: ($<) means main.c
############################################################################
myprogram1 : myprogram1.o

7.-Si después de unos momentos tras haber escrito el comando “make” ves algo como:
g++ -g -Wall -fPIC -Wno-deprecated -ggdb -pthread -stdlib=libc++ -std=c++11 -m64 -I/Users/Fer/root/root-6.06.06/include -Iaux   -c -o myprogram1.o myprogram1.cpp
compiling and linking myprogram1
Significa que no hubo problemas, específicamente la parte de “compiling and linking myprogram1”

7.5.-Si ves algún mensaje de error en tu terminal: verifica que la dirección del archivo es correcta en la línea 41, y que dentro del folder “myprogram1” tengas los folders “lib” y “bin”, también verifica que no hayas hecho cambios en el “makefile”

8.-Si tu archivo se compiló sin problemas ahora puedes correrlo escribiendo en la terminal “bin/myprogram1”.
Si todo sale bien verás esto en tu terminal: “Info in <TCanvas::Print>: pdf file masaW.pdf has been created”

9.-Si vas al folder “myprogram1” en este deberías de encontrar el archivo pdf “masaW.pdf” que debería de ser una gráfica con valor máximo cerca de la masa conocida del bosón W de 80 GeV



Mi información de contacto por si puedo ayudar:
francofelix94@gmail.com
Faceboo: Fernando Franco Félix
